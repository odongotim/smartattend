<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Attendance QR | Admin</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <style>
        body { font-family: sans-serif; text-align: center; padding: 40px; background: #f4f7f6; }
        .card { background: #007bff; padding: 30px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); display: inline-block; }
        input { padding: 12px; width: 250px; border: 1px solid #ddd; border-radius: 5px; margin-bottom: 10px; }
        #qrcode { margin: 20px auto; padding: 10px; background: #fff; display: inline-block; border: 1px solid #eee; }
        .btn { padding: 10px 20px; cursor: pointer; border: none; border-radius: 5px; font-weight: bold; }
        .btn-generate { background: #28a745; color: white; }
        .btn-download { background: #28a745; color: white; margin-top: 15px; display: none; }
    </style>
</head>
<body>

    <div class="card">
        <h2>Generate Attendance QR</h2>
        <p>Enter Session Name (e.g., ComputerScience_101)</p>
        <input type="text" id="qr-text" placeholder="Session Name/ID">
        <br>
        <button class="btn btn-generate" onclick="generateQR()">Generate QR Code</button><br>
        
        <div id="qrcode"></div>
        
        <br>
        <button id="download-btn" class="btn btn-download" onclick="downloadQR()">Download QR Image</button>
        <br><br>
        <a href="dashboard.html" style="text-decoration: none;">Back to Dashboard</a>
    </div>

    <script>
        let qrcode = new QRCode(document.getElementById("qrcode"), {
            width: 250,
            height: 250
        });

        function generateQR() {
    const sessionName = document.getElementById("qr-text").value.trim();
    if (!sessionName) return alert("Please enter a session name!");

    // Create a string: SessionName|Timestamp
    // Example: "Physics_Class|1740602501000"
    const qrData = `${sessionName}|${Date.now()}`;
    
    qrcode.clear();
    qrcode.makeCode(qrData); // Generate the actual QR
    
    document.getElementById("download-btn").style.display = "inline-block";
    console.log("QR Data Generated:", qrData);
}
          
        function downloadQR() {
            const img = document.querySelector("#qrcode img");
            if (!img) return;
            
            const link = document.createElement("a");
            link.href = img.src;
            link.download = `Attendance_QR_${new Date().toLocaleDateString()}.png`;
            link.click();
        }
    </script>
</body>
</html>