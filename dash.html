<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <section class="dash">
        <h3>Attendance Sheet</h3>

<p>
  <strong>Total Attendance:</strong> <span id="total">0</span><br>
  <strong>Today:</strong> <span id="today">0</span>
</p>

<button onclick="loadDashboard()">Refresh Data</button>

<table border="1" cellpadding="8" cellspacing="0">
  <thead>
    <tr>
      <th>Time</th>
      <th>QR Data</th>
    </tr>
  </thead>
  <tbody id="attendanceTable"></tbody>
</table>
    </section>
    
<script>
const DASHBOARD_URL = "https://script.google.com/macros/s/AKfycbwJPf8bQllCAcha58QRp0qk6c_iCZCVTHBDMDs-6Em85uoIvfMzGDkBzearGH7ZeRosaQ/exec";

function loadDashboard() {
  fetch(DASHBOARD_URL)
    .then(res => res.json())
    .then(data => {
      document.getElementById("total").innerText = data.total;
      document.getElementById("today").innerText = data.today;

      const tbody = document.getElementById("attendanceTable");
      tbody.innerHTML = "";

      data.rows.forEach(row => {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${row.time}</td><td>${row.qr}</td>`;
        tbody.appendChild(tr);
      });
    })
}

// Auto-load on admin login
if (localStorage.getItem("isAdmin") === "true") {
  loadDashboard();
}
</script>
</body>
</html>